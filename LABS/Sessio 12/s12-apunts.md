# <img src="https://github.com/artHub-j/dabd-apunts-artuaragon/assets/92806890/bd0f85c2-26ab-488e-98e3-cce94a095788" alt="Logo_UPC svg" width="40" height="40"> dabd-apunts-artuaragon | Sessió 12 | DL 3 JUNY 2024 | 

## 5) Feina a fer

Cal adaptar l'script bigger.py de la Sessió 7. Índexs que crea 900 comptes, 500 adreces, 1000 titulars i 4000 contractes per fer-ho en un KEYSPACE de Cassandra anomenat bank. L'has de pujar a la tasca d'aquesta sessió. Consells:

- Aprèn a usar la llibreria cassandra-driver en poc temps a partir d'exemples. Mira't exemples de codi en recursos a la web.

- No has de crear una taula de Cassandra per cada taula de l'esquema relacional. Recordar que a Cassandra, com a la majoria de les BD no relacionals, pots guardar valors no atòmics en els camps, per això disposa dels tipus list i set, amb list podem guardar una llista de valors amb repeticions i amb set una llista de valors sense repeticions. Per exemple, com que la taula titular només guarda el owner_id del titular i la seva adreça, els podem guardar directament dins la taula adreces: cada adreça tindrà un set amb els titulars que viuen en aquella adreça. O dins la taula comptes podem guardar els titulars de cada compte, o sigui els contractes (own_id i owner). A una adreça hi viuen pocs titulars i un compte té pocs titulars, per tant seran llistes/conjunts molt petits. A més és molt habitual les operacions de consulta de les dades d'un compte i les dades d'una adreça. Així, amb una única operació de lectura i sense haver de fer joins perquè no en tenim, podem obtenir totes les dades d'un compte (tipus, saldo i titulars del compte). Idem amb la lectura d'una adreça i les persones que hi viuen.
- El nombre de contractes d'un compte i el nombre de titulars d'una adreça han de ser aleatoris però com a mínim n'hi ha d'haver un (per exemple no té sentit un compte sense cap contracte, el compte ha de pertànyer com a mínim a una persona).
- Cada vegada que s'executi l'script cal que elimini els registres de totes les taules de forma que desprès d'executar-lo han d'haver-hi sempre 900 comptes, 500 adreces, 1000 titulars i 4000 contractes.
- El mateix script NO ha de crear els índexs que siguin necessaris per accelerar els accessos a les taules o per evitar dades repetides (índexs únics), doncs Cassandra no disposa de UK per no fer lentes les escriptures quan s'intenta evitar duplicitats. Només cal dissenyar les PK adequades. Algunes comprovacions per evitar repeticions les hauràs de fer a nivell de codi, per exemple per comprovar no afegir dos titulars amb el mateix owner_id en adreces diferents o en el mateix compte bancari.